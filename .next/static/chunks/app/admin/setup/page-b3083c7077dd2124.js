(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[912],{2919:(e,t,a)=>{Promise.resolve().then(a.bind(a,3132))},3132:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});var l=a(5155),n=a(2115);function s(){let[e,t]=(0,n.useState)(""),[a,s]=(0,n.useState)(""),[r,i]=(0,n.useState)(""),[d,o]=(0,n.useState)(!1),[c,u]=(0,n.useState)([]),E=async t=>{t.preventDefault(),u([]),o(!0);try{if(!e.trim())return void u(["❌ Service Role Key requis"]);u(["\uD83D\uDD0D Initialisation du setup..."]);let t=await fetch("/api/setup-db",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({serviceRoleKey:e,adminEmail:a,adminPassword:r})}),l=await t.json();l.logs&&u(l.logs),l.success?u(e=>[...e,"✅ Setup API compl\xe9t\xe9!","\uD83D\uDCCB Prochaine \xe9tape: Cr\xe9er les tables"]):u(e=>[...e,"❌ ".concat(l.error)])}catch(e){u(["❌ Erreur: "+(e instanceof Error?e.message:"Inconnue")])}finally{o(!1)}};return(0,l.jsx)("div",{className:"min-h-screen bg-gray-900 text-white p-8",children:(0,l.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,l.jsx)("h1",{className:"text-4xl font-bold mb-2 text-purple",children:"Setup Admin Panel"}),(0,l.jsx)("p",{className:"text-gray-400 mb-8",children:"Initialise Supabase avec les tables et l'utilisateur admin"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8",children:[(0,l.jsxs)("form",{onSubmit:E,className:"bg-gray-800 rounded-lg p-6 space-y-4 border border-gray-700",children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-purple mb-4",children:"\xc9tape 1: Donn\xe9es"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-semibold mb-2",children:"Service Role Key *"}),(0,l.jsx)("textarea",{value:e,onChange:e=>t(e.target.value),placeholder:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",className:"w-full bg-gray-700 text-white border border-gray-600 rounded-lg p-3 focus:outline-none focus:border-purple text-xs font-mono",rows:5,required:!0}),(0,l.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"\uD83D\uDCCD Supabase Dashboard → Settings → API → Service Role Secret"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-semibold mb-2",children:"Email Admin"}),(0,l.jsx)("input",{type:"email",value:a,onChange:e=>s(e.target.value),className:"w-full bg-gray-700 text-white border border-gray-600 rounded-lg p-3 focus:outline-none focus:border-purple"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-semibold mb-2",children:"Mot de passe Admin"}),(0,l.jsx)("input",{type:"password",value:r,onChange:e=>i(e.target.value),className:"w-full bg-gray-700 text-white border border-gray-600 rounded-lg p-3 focus:outline-none focus:border-purple"})]}),(0,l.jsx)("button",{type:"submit",disabled:d,className:"w-full bg-purple hover:bg-purple-dark disabled:opacity-50 text-white font-bold py-3 rounded-lg transition",children:d?"⏳ Traitement...":"\uD83D\uDE80 1. Cr\xe9er Utilisateur Admin"})]}),(0,l.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-purple mb-4",children:"\xc9tape 2: Logs"}),(0,l.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto font-mono text-xs",children:0===c.length?(0,l.jsx)("p",{className:"text-gray-500",children:"Les logs appara\xeetront ici..."}):c.map((e,t)=>(0,l.jsx)("div",{className:"bg-gray-700 p-2 rounded text-gray-300",children:e},t))})]})]}),(0,l.jsxs)("div",{className:"bg-blue-900/30 border border-blue-700 rounded-lg p-6 mb-8",children:[(0,l.jsx)("h3",{className:"font-bold text-blue-400 mb-4",children:"\uD83D\uDCCB \xc9tape 3: Cr\xe9er les Tables Manuellement"}),(0,l.jsx)("p",{className:"text-sm mb-4 text-gray-300",children:"Apr\xe8s avoir cliqu\xe9 sur le bouton ci-dessus, va dans Supabase Dashboard et cr\xe9e les tables:"}),(0,l.jsxs)("details",{className:"text-xs",children:[(0,l.jsx)("summary",{className:"cursor-pointer text-blue-400 font-semibold mb-2",children:"➕ Copier/Coller le SQL"}),(0,l.jsx)("pre",{className:"bg-gray-900 p-3 rounded mt-2 overflow-x-auto text-gray-300",children:'CREATE TABLE IF NOT EXISTS biblical_verses (\n  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),\n  text TEXT NOT NULL,\n  reference VARCHAR(100) NOT NULL,\n  created_at TIMESTAMP DEFAULT now(),\n  updated_at TIMESTAMP DEFAULT now()\n);\n\nCREATE TABLE IF NOT EXISTS content_sections (\n  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),\n  section_name VARCHAR(100) NOT NULL UNIQUE,\n  title VARCHAR(255),\n  description TEXT,\n  content TEXT,\n  created_at TIMESTAMP DEFAULT now(),\n  updated_at TIMESTAMP DEFAULT now()\n);\n\nCREATE TABLE IF NOT EXISTS images (\n  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),\n  title VARCHAR(255),\n  url TEXT NOT NULL,\n  section VARCHAR(100),\n  order_index INTEGER DEFAULT 0,\n  created_at TIMESTAMP DEFAULT now()\n);\n\nCREATE TABLE IF NOT EXISTS events (\n  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),\n  title VARCHAR(255) NOT NULL,\n  description TEXT,\n  date TIMESTAMP NOT NULL,\n  location VARCHAR(255),\n  image_url TEXT,\n  created_at TIMESTAMP DEFAULT now()\n);\n\nCREATE TABLE IF NOT EXISTS podcasts (\n  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),\n  title VARCHAR(255) NOT NULL,\n  description TEXT,\n  audio_url TEXT,\n  created_at TIMESTAMP DEFAULT now()\n);\n\nALTER TABLE biblical_verses ENABLE ROW LEVEL SECURITY;\nALTER TABLE content_sections ENABLE ROW LEVEL SECURITY;\nALTER TABLE images ENABLE ROW LEVEL SECURITY;\nALTER TABLE events ENABLE ROW LEVEL SECURITY;\nALTER TABLE podcasts ENABLE ROW LEVEL SECURITY;\n\nCREATE POLICY "Allow public read" ON biblical_verses FOR SELECT USING (true);\nCREATE POLICY "Allow authenticated write" ON biblical_verses FOR INSERT WITH CHECK (auth.role() = \'authenticated\');\nCREATE POLICY "Allow authenticated update" ON biblical_verses FOR UPDATE USING (auth.role() = \'authenticated\');\nCREATE POLICY "Allow authenticated delete" ON biblical_verses FOR DELETE USING (auth.role() = \'authenticated\');\n\nCREATE POLICY "Allow public read" ON content_sections FOR SELECT USING (true);\nCREATE POLICY "Allow authenticated write" ON content_sections FOR INSERT WITH CHECK (auth.role() = \'authenticated\');\nCREATE POLICY "Allow authenticated update" ON content_sections FOR UPDATE USING (auth.role() = \'authenticated\');\nCREATE POLICY "Allow authenticated delete" ON content_sections FOR DELETE USING (auth.role() = \'authenticated\');\n\nCREATE POLICY "Allow public read" ON images FOR SELECT USING (true);\nCREATE POLICY "Allow authenticated write" ON images FOR INSERT WITH CHECK (auth.role() = \'authenticated\');\nCREATE POLICY "Allow authenticated update" ON images FOR UPDATE USING (auth.role() = \'authenticated\');\nCREATE POLICY "Allow authenticated delete" ON images FOR DELETE USING (auth.role() = \'authenticated\');\n\nCREATE POLICY "Allow public read" ON events FOR SELECT USING (true);\nCREATE POLICY "Allow authenticated write" ON events FOR INSERT WITH CHECK (auth.role() = \'authenticated\');\nCREATE POLICY "Allow authenticated update" ON events FOR UPDATE USING (auth.role() = \'authenticated\');\nCREATE POLICY "Allow authenticated delete" ON events FOR DELETE USING (auth.role() = \'authenticated\');\n\nCREATE POLICY "Allow public read" ON podcasts FOR SELECT USING (true);\nCREATE POLICY "Allow authenticated write" ON podcasts FOR INSERT WITH CHECK (auth.role() = \'authenticated\');\nCREATE POLICY "Allow authenticated update" ON podcasts FOR UPDATE USING (auth.role() = \'authenticated\');\nCREATE POLICY "Allow authenticated delete" ON podcasts FOR DELETE USING (auth.role() = \'authenticated\');'})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{className:"bg-purple/10 border border-purple/50 rounded-lg p-4",children:[(0,l.jsx)("h3",{className:"font-bold text-purple mb-2",children:"1️⃣ Service Role Key"}),(0,l.jsx)("p",{className:"text-sm text-gray-400",children:"Colle ta cl\xe9 service role Supabase"})]}),(0,l.jsxs)("div",{className:"bg-purple/10 border border-purple/50 rounded-lg p-4",children:[(0,l.jsx)("h3",{className:"font-bold text-purple mb-2",children:"2️⃣ Clique Bouton"}),(0,l.jsx)("p",{className:"text-sm text-gray-400",children:"Cr\xe9e l'utilisateur admin automatiquement"})]}),(0,l.jsxs)("div",{className:"bg-purple/10 border border-purple/50 rounded-lg p-4",children:[(0,l.jsx)("h3",{className:"font-bold text-purple mb-2",children:"3️⃣ Cr\xe9e Tables"}),(0,l.jsx)("p",{className:"text-sm text-gray-400",children:"Copie/colle le SQL manuellement"})]})]})]})})}}},e=>{e.O(0,[441,255,358],()=>e(e.s=2919)),_N_E=e.O()}]);